<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>SaludPro ¬∑ Herramienta Cl√≠nica Institucional</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{
  --accent:#00b4d8;
  --accent-2:#43e97b;
  --accent-3:#f9fafc;
  --bg: linear-gradient(135deg,#00b4d8 0%,#43e97b 100%);
  --glass: rgba(255,255,255,0.88);
  --shadow: 0 8px 40px rgba(67,233,123,.13);
  --radius: 22px;
  --font:'Roboto',system-ui,-apple-system,"Segoe UI",Arial;
  --inputbg:rgba(255,255,255,0.74);
  --focus: #43e97b;
}
body{background:var(--bg);margin:0;font-family:var(--font);color:#022;min-height:100vh;}
.app{max-width:1260px;margin:auto;padding:0 0 28px 0;}
header{display:flex;align-items:center;justify-content:space-between;background:var(--glass);box-shadow:var(--shadow);border-radius:var(--radius);padding:20px 32px;margin:28px 0;}
.logo{font-weight:700;font-size:2.3rem;color:#fff;background:linear-gradient(135deg,var(--accent),var(--accent-2));border-radius:16px;padding:16px 40px;letter-spacing:2px;box-shadow:0 5px 22px #00b4d833;}
nav{display:flex;gap:14px;margin:16px 0 20px 0;align-items:center;justify-content:center;}
nav button{font-weight:700;padding:14px 22px;border-radius:16px;border:none;background:linear-gradient(90deg,#00b4d8 60%,#43e97b 100%);color:#fff;cursor:pointer;box-shadow:0 3px 11px #00b4d822;transition:.13s;}
nav button:hover{filter:brightness(1.08);transform:scale(1.06);}
nav input{font-size:1.1em;padding:11px 18px;border-radius:14px;border:1.5px solid #00b4d8;background:var(--inputbg);outline:none;max-width:350px;}
nav input:focus{border-color:var(--focus);}
.modal-backdrop{display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,180,216,0.18);z-index:100;}
.panel{display:none;flex-direction:column;background:var(--glass);box-shadow:var(--shadow);border-radius:var(--radius);padding:32px 28px 24px 28px;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:101;min-width:350px;max-width:98vw;max-height:92vh;overflow:auto;animation:fadein .22s;}
@keyframes fadein{from{opacity:0;transform:translate(-50%,-56%);}to{opacity:1;transform:translate(-50%,-50%);}}
.panel.active{display:flex;}
.panel .panel-nav{display:flex;gap:10px;margin-bottom:18px;flex-wrap:wrap;}
.panel .panel-nav button{padding:9px 17px;background:#fff;color:#00b4d8;border:1px solid #43e97b;}
.panel .panel-nav button.active{background:linear-gradient(90deg,#00b4d8,#43e97b);color:#fff;}
.close-btn{position:absolute;top:14px;right:22px;background:transparent;border:none;font-size:2.1rem;cursor:pointer;color:#00b4d8;}
h2,h3{margin:0 0 16px 0;}
.fav-btn{background:transparent;border:none;color:#00b4d8;font-size:1.44em;cursor:pointer;vertical-align:middle;}
.fav-btn.faved{color:#43e97b;}
ul{padding-left:22px;}
input,textarea,select{background:var(--inputbg);border-radius:12px;border:1.5px solid #43e97b;outline:none;padding:8px 12px;font-size:1.08rem;margin:5px 0;}
input:focus,textarea:focus,select:focus{border-color:#00b4d8;}
.profile-box,.pae-box,.patient-box{background:var(--glass);border-radius:20px;box-shadow:0 2px 12px #43e97b44;padding:20px;margin:12px 0;}
.profile-box h3,.pae-box h3,.patient-box h3{margin-bottom:12px;}
.profile-label{font-weight:500;margin-top:11px;}
.pae-save,.patient-save{margin-top:10px;}
.panel-block{margin-bottom:18px;}
.list-card{background:var(--accent-3);border-radius:11px;padding:14px 17px;margin-bottom:7px;box-shadow:0 2px 10px #00b4d822;}
.copy-btn{background:transparent;border:none;font-size:1.1em;color:#00b4d8;cursor:pointer;margin-left:7px;}
.copy-btn:hover{color:#43e97b;}
@media (max-width:600px){.app{padding:2px;}.panel{padding:10px;min-width:98vw;}}
</style>
</head>
<body>
<div class="app">
  <header>
    <span class="logo">SaludPro</span>
    <span>Herramienta Cl√≠nica Institucional</span>
  </header>
  <nav>
    <input id="globalSearchBox" placeholder="üîé Buscar en toda la herramienta...">
    <button data-panel="perfil">Perfil</button>
    <button data-panel="pacientes">Pacientes</button>
    <button data-panel="pae">PAE</button>
    <button data-panel="procedimientos">Procedimientos</button>
    <button data-panel="enfermedades">Enfermedades</button>
    <button data-panel="interacciones">Interacciones</button>
    <button data-panel="combinador">Combinador</button>
    <button data-panel="educacion">Educaci√≥n</button>
    <button data-panel="favoritos">Favoritos ‚òÖ</button>
    <button data-panel="ayuda">Ayuda</button>
  </nav>
  <div class="modal-backdrop" id="modalBackdrop"></div>

  <!-- Panel Perfil -->
  <section class="panel" id="panel-perfil">
    <button class="close-btn" title="Cerrar">&times;</button>
    <div class="profile-box">
      <h3>Perfil institucional</h3>
      <label class="profile-label">Nombre completo:</label>
      <input id="userName" placeholder="Nombre completo">
      <label class="profile-label">Usuario ID:</label>
      <input id="userId" placeholder="ID institucional">
      <label class="profile-label">Rol:</label>
      <select id="userRol">
        <option>Enfermer√≠a</option>
        <option>M√©dico</option>
        <option>Fisioterapia</option>
        <option>Nutrici√≥n</option>
        <option>Administrativo</option>
        <option>Otro</option>
      </select>
      <button id="profileSave" class="pae-save">Guardar perfil</button>
      <div id="profileMsg" style="margin-top:7px;color:#00b4d8;"></div>
    </div>
  </section>
  <!-- Panel Pacientes -->
  <section class="panel" id="panel-pacientes">
    <button class="close-btn" title="Cerrar">&times;</button>
    <div class="patient-box">
      <h3>Registro de paciente</h3>
      <label class="profile-label">Nombre:</label>
      <input id="patName" placeholder="Nombre paciente">
      <label class="profile-label">Edad:</label>
      <input id="patEdad" type="number" placeholder="Edad">
      <label class="profile-label">G√©nero:</label>
      <select id="patGen"><option>M</option><option>F</option><option>O</option></select>
      <label class="profile-label">Diagn√≥stico:</label>
      <input id="patDiag" placeholder="Diagn√≥stico principal">
      <label class="profile-label">Alergias:</label>
      <input id="patAlergias" placeholder="Alergias">
      <label class="profile-label">Signos vitales:</label>
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;">
        <input id="patTA" placeholder="TA mmHg">
        <input id="patFC" placeholder="FC lpm">
        <input id="patFR" placeholder="FR rpm">
        <input id="patTemp" placeholder="Temp ¬∞C">
        <input id="patSpO2" placeholder="SpO2 %">
        <input id="patGluc" placeholder="Glucosa mg/dL">
      </div>
      <button id="patSave" class="patient-save">Guardar paciente</button>
      <div id="patMsg" style="margin-top:7px;color:#43e97b;"></div>
    </div>
    <div style="margin-top:20px;">
      <h3>Pacientes guardados</h3>
      <div id="patList"></div>
    </div>
  </section>
  <!-- Panel PAE -->
  <section class="panel" id="panel-pae">
    <button class="close-btn" title="Cerrar">&times;</button>
    <div class="pae-box">
      <h3>PAE (Proceso de Atenci√≥n de Enfermer√≠a)</h3>
      <label class="profile-label">Paciente:</label>
      <select id="paePat"></select>
      <label class="profile-label">Diagn√≥stico de enfermer√≠a:</label>
      <textarea id="paeDiag" placeholder="Diagn√≥stico de enfermer√≠a"></textarea>
      <label class="profile-label">Plan / intervenciones:</label>
      <textarea id="paePlan" placeholder="Plan / intervenciones"></textarea>
      <button id="paeSave" class="pae-save">Guardar PAE</button>
      <button id="paeExport" class="pae-save">Exportar PAE (JSON)</button>
      <div id="paeMsg" style="margin-top:7px;color:#43e97b;"></div>
    </div>
    <div style="margin-top:20px;">
      <h3>PAEs guardados</h3>
      <div id="paeList"></div>
    </div>
  </section>
  <!-- Panel Procedimientos -->
  <section class="panel" id="panel-procedimientos">
    <button class="close-btn" title="Cerrar">&times;</button>
    <div class="panel-nav">
      <button data-sub="higiene" class="active">Higiene</button>
      <button data-sub="farmaco">Farmacolog√≠a</button>
      <button data-sub="nutricion">Nutrici√≥n</button>
      <button data-sub="curaciones">Curaciones</button>
      <button data-sub="emergencias">Emergencias</button>
      <button data-sub="movilizacion">Movilizaci√≥n</button>
      <button data-sub="infeccion">Infecci√≥n</button>
      <button data-sub="pediatria">Pediatr√≠a</button>
      <button data-sub="geriatria">Geriatr√≠a</button>
      <button data-sub="terapia">Terapia respiratoria</button>
      <button data-sub="urgencias">Urgencias</button>
      <button data-sub="quirurgicos">Quir√∫rgicos</button>
      <button data-sub="hemodinamia">Hemodinamia</button>
      <button data-sub="transfusion">Transfusiones</button>
      <button data-sub="monitorizacion">Monitorizaci√≥n</button>
    </div>
    <div id="procedimientos-content"></div>
  </section>
  <!-- Panel Enfermedades -->
  <section class="panel" id="panel-enfermedades">
    <button class="close-btn" title="Cerrar">&times;</button>
    <div class="panel-nav">
      <button data-sub="cronicas" class="active">Cr√≥nicas</button>
      <button data-sub="infecciosas">Infecciosas</button>
      <button data-sub="respiratorias">Respiratorias</button>
      <button data-sub="digestivas">Digestivas</button>
      <button data-sub="neurologicas">Neurol√≥gicas</button>
      <button data-sub="oncologicas">Oncol√≥gicas</button>
      <button data-sub="hematologicas">Hematol√≥gicas</button>
      <button data-sub="otras">Otras</button>
    </div>
    <div id="enfermedades-content"></div>
  </section>
  <!-- Panel Interacciones -->
  <section class="panel" id="panel-interacciones">
    <button class="close-btn" title="Cerrar">&times;</button>
    <div class="panel-nav">
      <button data-sub="vih" class="active">VIH</button>
      <button data-sub="diabetes">Diabetes</button>
      <button data-sub="hta">Hipertensi√≥n</button>
      <button data-sub="renal">Renal</button>
      <button data-sub="cardio">Cardiopat√≠as</button>
      <button data-sub="respiratoria">Respiratorias</button>
      <button data-sub="digestiva">Digestivas</button>
      <button data-sub="neurologica">Neurol√≥gicas</button>
      <button data-sub="oncologica">Oncol√≥gicas</button>
      <button data-sub="hematologica">Hematol√≥gicas</button>
      <button data-sub="polifarmacia">Polifarmacia</button>
    </div>
    <div id="interacciones-content"></div>
  </section>
  <!-- Panel Combinador -->
  <section class="panel" id="panel-combinador">
    <button class="close-btn" title="Cerrar">&times;</button>
    <h2>Verifica combinaci√≥n de medicamentos</h2>
    <input id="medA" placeholder="Medicamento A">
    <input id="medB" placeholder="Medicamento B">
    <button id="checkComb" style="margin-top:8px;">Verificar</button>
    <div id="comb-result" style="margin-top:10px;"></div>
    <details style="margin-top:18px;"><summary>Lista completa de interacciones cr√≠ticas</summary>
      <div id="all-inter-list" style="margin-top:7px;"></div>
    </details>
  </section>
  <!-- Panel Educaci√≥n -->
  <section class="panel" id="panel-educacion">
    <button class="close-btn" title="Cerrar">&times;</button>
    <h3>Recursos de Educaci√≥n y Refresco</h3>
    <input id="eduSearchBox" placeholder="Buscar recurso, tip, video, manual, protocolo...">
    <div id="educacion-content"></div>
    <div class="panel-block">
      <h4>Recursos destacados</h4>
      <div class="list-card"><b>Lavado de manos OMS</b> - Video y gu√≠a oficial</div>
      <div class="list-card"><b>Manejo del paciente diab√©tico</b> - Manual institucional, video</div>
      <div class="list-card"><b>Fisioterapia respiratoria en EPOC</b> - Ejercicios guiados</div>
      <div class="list-card"><b>Nutrici√≥n en insuficiencia renal</b> - Recomendaciones y tablas</div>
      <div class="list-card"><b>Uso seguro de medicamentos</b> - Checklist de errores y doble control</div>
      <div class="list-card"><b>Prevenci√≥n de ca√≠das en adultos mayores</b> - Tips y gr√°ficos</div>
    </div>
  </section>
  <!-- Panel Ayuda -->
  <section class="panel" id="panel-ayuda">
    <button class="close-btn" title="Cerrar">&times;</button>
    <h2>Ayuda y recomendaciones</h2>
    <ul>
      <li>Crea tu perfil institucional, registra pacientes y guarda PAEs.</li>
      <li>Usa la b√∫squeda global para encontrar cualquier dato, procedimiento, recurso o paciente.</li>
      <li>Marca favoritos para acceso r√°pido.</li>
      <li>En Interacciones, consulta combinaciones peligrosas seg√∫n enfermedad.</li>
      <li>El Combinador verifica combinaciones cr√≠ticas, consulta bases oficiales.</li>
      <li>Doble clic en cualquier elemento lo copia al portapapeles.</li>
      <li>Sector Educaci√≥n: refresca protocolos, videos, manuales y tips por √°rea.</li>
    </ul>
  </section>
  <!-- Panel Favoritos -->
  <section class="panel" id="panel-favoritos">
    <button class="close-btn" title="Cerrar">&times;</button>
    <h2>Favoritos</h2>
    <div id="favoritos-content"></div>
  </section>
</div>
<script>
// --- DATA ampliada ---
const procedimientos = {
  higiene: [
    {id:'lavado_manos',titulo:'Lavado de manos',desc:'Prevenci√≥n de infecciones. Agua y jab√≥n/gel, frotar ‚â•20s, secar.'},
    {id:'higiene_oral',titulo:'Higiene oral',desc:'Prevenci√≥n de infecciones orales y cuidado de mucosas.'},
    {id:'ba√±o_cama',titulo:'Ba√±o en cama',desc:'Higiene paciente encamado. Proteger intimidad.'},
    {id:'aseo_genital',titulo:'Aseo genital',desc:'Prevenci√≥n de infecciones urinarias, uso de t√©cnica est√©ril.'}
  ],
  farmaco: [
    {id:'admin_oral',titulo:'Administraci√≥n oral',desc:'Verificar 5 correctos.'},
    {id:'admin_ev',titulo:'Administraci√≥n EV',desc:'Preparaci√≥n y administraci√≥n por v√≠a venosa.'},
    {id:'oxigenoterapia',titulo:'Oxigenoterapia',desc:'C√°nula/m√°scara seg√∫n indicaci√≥n.'},
    {id:'vacunas',titulo:'Vacunas IM',desc:'Preparaci√≥n est√©ril, registro de lote.'},
    {id:'dosis_peso',titulo:'Dosis seg√∫n peso',desc:'Calcular dosis por kg.'}
  ],
  nutricion: [
    {id:'alimentacion_asistida',titulo:'Asistencia en alimentaci√≥n',desc:'Prevenci√≥n de aspiraci√≥n.'},
    {id:'sonda_nasogastrica',titulo:'SNG',desc:'Nutrici√≥n enteral, comprobar posici√≥n.'}
  ],
  curaciones: [
    {id:'curacion_simple',titulo:'Curaci√≥n simple de herida',desc:'Cambio de ap√≥sito en heridas limpias.'},
    {id:'curacion_quirurgica',titulo:'Curaci√≥n quir√∫rgica',desc:'Seguimiento de heridas operatorias.'},
    {id:'curacion_escaras',titulo:'Curaci√≥n de escaras',desc:'Manejo y alivio de presi√≥n.'}
  ],
  emergencias: [
    {id:'rcp',titulo:'RCP b√°sica',desc:'Compresiones 100-120/min.'},
    {id:'anafilaxia',titulo:'Anafilaxia',desc:'Reconocer y actuar r√°pido.'},
    {id:'hemorragia',titulo:'Control de hemorragia',desc:'Compresi√≥n directa, torniquete si necesario.'}
  ],
  movilizacion: [
    {id:'transferencia',titulo:'Transferencia segura',desc:'T√©cnicas y dispositivos de ayuda.'},
    {id:'posicionamiento',titulo:'Cambio de dec√∫bito',desc:'Prevenci√≥n de escaras.'}
  ],
  infeccion: [
    {id:'aislamiento_contacto',titulo:'Aislamiento por contacto',desc:'EPP y manejo de residuos.'},
    {id:'control_cateter',titulo:'Control de cat√©ter',desc:'T√©cnica est√©ril y registro.'}
  ],
  pediatria: [
    {id:'vacuna_bcg',titulo:'Vacuna BCG',desc:'Prevenci√≥n de tuberculosis en ni√±os.'},
    {id:'reanimacion_neonatal',titulo:'RCP neonatal',desc:'Pasos adaptados a neonatos.'}
  ],
  geriatria: [
    {id:'prevencion_caidas',titulo:'Prevenci√≥n de ca√≠das',desc:'Evaluar riesgo y adaptar entorno.'},
    {id:'cuidados_piel',titulo:'Cuidados de piel fr√°gil',desc:'Uso de emolientes y reducci√≥n de fricci√≥n.'}
  ],
  terapia: [
    {id:'cpap',titulo:'Terapia CPAP',desc:'Dispositivo de presi√≥n positiva continua.'},
    {id:'nebulizacion',titulo:'Nebulizaci√≥n',desc:'Preparaci√≥n y administraci√≥n de f√°rmacos inhalados.'}
  ],
  urgencias: [
    {id:'triage',titulo:'Triage',desc:'Clasificaci√≥n de pacientes seg√∫n gravedad.'},
    {id:'via_aerea',titulo:'Aseguramiento v√≠a a√©rea',desc:'Maniobras y dispositivos.'}
  ],
  quirurgicos: [
    {id:'preoperatorio',titulo:'Preparaci√≥n preoperatoria',desc:'Verificaci√≥n y preparaci√≥n del paciente.'},
    {id:'control_drenajes',titulo:'Control de drenajes',desc:'Registro y manejo de drenajes quir√∫rgicos.'}
  ],
  hemodinamia: [
    {id:'monitorizacion_invasiva',titulo:'Monitorizaci√≥n invasiva',desc:'Uso de cat√©teres y registro hemodin√°mico.'}
  ],
  transfusion: [
    {id:'transfusion_sanguinea',titulo:'Transfusi√≥n sangu√≠nea',desc:'Verificaci√≥n, rastreo y monitorizaci√≥n.'}
  ],
  monitorizacion: [
    {id:'monitor_paciente',titulo:'Monitorizaci√≥n continua',desc:'Uso adecuado de monitores multipar√°metro.'}
  ]
};
const enfermedades = {
  cronicas:[
    {id:'vih',titulo:'VIH/SIDA',desc:'Tratamiento antirretroviral, prevenci√≥n infecciones oportunistas.'},
    {id:'diabetes',titulo:'Diabetes Mellitus',desc:'Control gluc√©mico, uso de insulina.'},
    {id:'hta',titulo:'Hipertensi√≥n arterial',desc:'Control TA, adherencia farmacol√≥gica.'},
    {id:'renal',titulo:'Insuficiencia renal',desc:'Control l√≠quidos, monitorizaci√≥n, di√°lisis.'},
    {id:'cardiopatia',titulo:'Cardiopat√≠a cr√≥nica',desc:'Monitorizaci√≥n, anticoagulaci√≥n, control de l√≠quidos.'},
    {id:'epoc',titulo:'EPOC',desc:'Oxigenoterapia, broncodilatadores.'},
    {id:'asma',titulo:'Asma',desc:'Educaci√≥n en inhaladores.'},
    {id:'artritis',titulo:'Artritis reumatoide',desc:'Control de dolor y movilidad.'}
  ],
  infecciosas:[
    {id:'tuberculosis',titulo:'Tuberculosis',desc:'Tratamiento prolongado, aislamiento.'},
    {id:'covid19',titulo:'COVID-19',desc:'Aislamiento, control respiratorio.'},
    {id:'meningitis',titulo:'Meningitis',desc:'Aislamiento y antibi√≥ticos.'}
  ],
  respiratorias:[
    {id:'epoc',titulo:'EPOC',desc:'Oxigenoterapia, broncodilatadores.'},
    {id:'asma',titulo:'Asma',desc:'Control de crisis.'},
    {id:'neumonia',titulo:'Neumon√≠a',desc:'Antibi√≥ticos, oxigenoterapia.'}
  ],
  digestivas:[
    {id:'cirrosis',titulo:'Cirrosis hep√°tica',desc:'Prevenci√≥n de encefalopat√≠a, sangrado.'},
    {id:'ulcera',titulo:'√ölcera g√°strica',desc:'Tratamiento farmacol√≥gico y dieta.'},
    {id:'colon_irritable',titulo:'Colon irritable',desc:'Modificaci√≥n dieta y control de s√≠ntomas.'}
  ],
  neurologicas:[
    {id:'parkinson',titulo:'Parkinson',desc:'Tratamiento farmacol√≥gico, rehabilitaci√≥n.'},
    {id:'epilepsia',titulo:'Epilepsia',desc:'Control farmacol√≥gico y educaci√≥n familiar.'}
  ],
  oncologicas:[
    {id:'leucemia',titulo:'Leucemia',desc:'Quimioterapia y soporte transfusional.'},
    {id:'cancer_mama',titulo:'C√°ncer de mama',desc:'Cirug√≠a, quimioterapia, radioterapia.'}
  ],
  hematologicas:[
    {id:'anemia',titulo:'Anemia',desc:'Evaluaci√≥n y tratamiento etiol√≥gico.'},
    {id:'trombocitopenia',titulo:'Trombocitopenia',desc:'Monitorizaci√≥n y manejo transfusional.'}
  ],
  otras:[
    {id:'fibromialgia',titulo:'Fibromialgia',desc:'Tratamiento multidisciplinario.'},
    {id:'lupus',titulo:'Lupus eritematoso',desc:'Monitorizaci√≥n inmunosupresores.'}
  ]
};
const interacciones = {
  vih:[{id:'int1',comb:'Ritonavir/lopinavir + estatinas',desc:'‚Üë Riesgo miopat√≠a/rabdomi√≥lisis.'},{id:'int2',comb:'Efavirenz + voriconazol',desc:'‚Üì Eficacia voriconazol.'},{id:'int3',comb:'Tenofovir + aciclovir',desc:'‚Üë Riesgo nefrotoxicidad.'},{id:'int4',comb:'Atazanavir + omeprazol',desc:'‚Üì Absorci√≥n atazanavir.'},{id:'int5',comb:'Darunavir + rifampicina',desc:'‚Üì Eficacia de darunavir.'},{id:'int6',comb:'Ritonavir + midazolam',desc:'‚Üë Niveles de midazolam (sedaci√≥n excesiva).'},{id:'int7',comb:'Efavirenz + metadona',desc:'Disminuye niveles de metadona, riesgo de abstinencia.'}],
  diabetes:[{id:'intd1',comb:'Warfarina + antidiab√©ticos',desc:'‚Üë Riesgo hipoglucemia y sangrado.'},{id:'intd2',comb:'Beta-bloqueadores + insulina',desc:'Ocultan hipoglucemia.'},{id:'intd3',comb:'Fluoroquinolonas + antidiab√©ticos',desc:'‚Üë Riesgo hipoglucemia.'},{id:'intd4',comb:'Prednisona + insulina',desc:'‚Üë Glucosa, ‚Üì eficacia insulina.'}],
  hta:[{id:'inth1',comb:'IECA/ARA II + espironolactona',desc:'‚Üë Riesgo hiperkalemia.'},{id:'inth2',comb:'Betabloqueantes + verapamilo',desc:'‚Üë Bradicardia.'},{id:'inth3',comb:'AINEs + antihipertensivos',desc:'‚Üì Eficacia, ‚Üë riesgo renal.'},{id:'inth4',comb:'IECA + litio',desc:'‚Üë Toxicidad por litio.'}],
  renal:[{id:'inr1',comb:'Metformina + insuficiencia renal',desc:'‚Üë Riesgo acidosis l√°ctica.'},{id:'inr2',comb:'AINEs + insuficiencia renal',desc:'‚Üë Riesgo insuficiencia renal aguda.'},{id:'inr3',comb:'IECA + diur√©ticos ahorradores de K',desc:'‚Üë Hiperkalemia.'}],
  cardio:[{id:'inc1',comb:'Warfarina + AINEs',desc:'‚Üë Riesgo hemorragia.'},{id:'inc2',comb:'Digoxina + verapamilo',desc:'‚Üë Toxicidad digoxina.'},{id:'inc3',comb:'Amiodarona + estatinas',desc:'‚Üë Riesgo miopat√≠a.'},{id:'inc4',comb:'Diur√©ticos + digoxina',desc:'‚Üë Riesgo toxicidad digoxina (hipopotasemia).'}],
  respiratoria:[{id:'inr1',comb:'Betabloqueantes + salbutamol',desc:'‚Üì Eficacia broncodilatador.'},{id:'inr2',comb:'Corticoides inhalados + azoles',desc:'‚Üë Efectos sist√©micos.'}],
  digestiva:[{id:'ind1',comb:'Omeprazol + clopidogrel',desc:'‚Üì Activaci√≥n de clopidogrel.'},{id:'ind2',comb:'Anticoagulantes + AINEs',desc:'‚Üë Riesgo de hemorragia digestiva.'}],
  neurologica:[{id:'inn1',comb:'Carbamazepina + antirretrovirales',desc:'‚Üì Eficacia de antirretrovirales.'},{id:'inn2',comb:'Fenito√≠na + antirretrovirales',desc:'‚Üì Eficacia de antirretrovirales.'}],
  oncologica:[{id:'ino1',comb:'Quimioterapia + AINEs',desc:'‚Üë Riesgo de toxicidad renal y digestiva.'}],
  hematologica:[{id:'ih1',comb:'Ciclosporina + azoles',desc:'‚Üë Niveles y toxicidad de ciclosporina.'}],
  polifarmacia:[{id:'inp1',comb:'Hierba de San Juan + antirretrovirales',desc:'‚Üì Eficacia de antirretrovirales.'},{id:'inp2',comb:'Carbamazepina + anticoagulantes',desc:'‚Üì Eficacia.'}]
};
const educaci√≥n = [
  {titulo:'Lavado de manos correcto',desc:'Gu√≠a y video OMS.'},
  {titulo:'Protocolo de RCP b√°sico',desc:'Material visual y checklist.'},
  {titulo:'Manejo del paciente diab√©tico',desc:'Manual de enfermer√≠a y video.'},
  {titulo:'Fisioterapia respiratoria en EPOC',desc:'T√©cnicas y ejercicios.'},
  {titulo:'Nutrici√≥n en insuficiencia renal',desc:'Recomendaciones y tablas.'},
  {titulo:'Uso seguro de medicamentos',desc:'Gu√≠a de errores frecuentes.'},
  {titulo:'Prevenci√≥n de ca√≠das en adultos mayores',desc:'Gr√°fico y tips.'},
  {titulo:'Educaci√≥n en uso de inhaladores',desc:'Video y protocolo.'},
  {titulo:'Protocolo transfusional',desc:'Gu√≠a de verificaci√≥n.'},
  {titulo:'Monitorizaci√≥n multipar√°metro',desc:'Manual de uso.'},
  {titulo:'Checklist quir√∫rgico',desc:'Listas para cirug√≠as seguras.'}
];
// --- FAVORITOS ---
function getFavs(){return JSON.parse(localStorage.getItem('saludpro_favs')||'[]');}
function setFavs(favs){localStorage.setItem('saludpro_favs',JSON.stringify(favs));}
function isFav(id){return getFavs().includes(id);}
function toggleFav(id){
  let favs=getFavs();
  if(favs.includes(id)){favs=favs.filter(f=>f!==id);}
  else{favs.push(id);}
  setFavs(favs);
  renderFavoritos();
  renderProcedimientos(document.querySelector('#panel-procedimientos .panel-nav button.active').dataset.sub);
  renderEnfermedades(document.querySelector('#panel-enfermedades .panel-nav button.active').dataset.sub);
  renderInteracciones(document.querySelector('#panel-interacciones .panel-nav button.active').dataset.sub);
}
// --- PANEL NAVIGATION MODAL ---
function showPanel(name){
  document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));
  document.getElementById('modalBackdrop').style.display='block';
  document.getElementById('panel-'+name).classList.add('active');
  if(name==='procedimientos') renderProcedimientos(document.querySelector('#panel-procedimientos .panel-nav button.active').dataset.sub);
  if(name==='enfermedades') renderEnfermedades(document.querySelector('#panel-enfermedades .panel-nav button.active').dataset.sub);
  if(name==='interacciones') renderInteracciones(document.querySelector('#panel-interacciones .panel-nav button.active').dataset.sub);
  if(name==='favoritos') renderFavoritos();
  if(name==='combinador') renderAllInterList();
  if(name==='pacientes') renderPatList();
  if(name==='pae') { renderPatSelect(); renderPAEList(); }
}
function closePanel(){
  document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));
  document.getElementById('modalBackdrop').style.display='none';
}
document.querySelectorAll('nav button').forEach(btn=>{
  btn.onclick = ()=>showPanel(btn.dataset.panel);
});
document.getElementById('modalBackdrop').onclick = closePanel;
document.querySelectorAll('.close-btn').forEach(btn=>{
  btn.onclick = closePanel;
});
// --- SUBNAV procedimientos ---
document.querySelectorAll('#panel-procedimientos .panel-nav button').forEach(btn=>{
  btn.onclick = function(){
    document.querySelectorAll('#panel-procedimientos .panel-nav button').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    renderProcedimientos(btn.dataset.sub);
  };
});
function renderProcedimientos(sub){
  let html = '<h2>'+sub.charAt(0).toUpperCase()+sub.slice(1)+'</h2><ul>';
  (procedimientos[sub]||[]).forEach(p=>{
    html += `<li ondblclick="copiar('${p.titulo}: ${p.desc}')" id="proc_${p.id}">
      <strong>${p.titulo}</strong>: ${p.desc}
      <button class="fav-btn${isFav(p.id)?' faved':''}" title="Favorito" onclick="toggleFav('${p.id}')">${isFav(p.id)?'‚òÖ':'‚òÜ'}</button>
      <button class="copy-btn" title="Copiar" onclick="copiar('${p.titulo}: ${p.desc}')">üìã</button>
    </li>`;
  });
  html+='</ul>';
  document.getElementById('procedimientos-content').innerHTML = html;
}
// --- SUBNAV enfermedades ---
document.querySelectorAll('#panel-enfermedades .panel-nav button').forEach(btn=>{
  btn.onclick = function(){
    document.querySelectorAll('#panel-enfermedades .panel-nav button').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    renderEnfermedades(btn.dataset.sub);
  };
});
function renderEnfermedades(sub){
  let html = '<h2>'+sub.charAt(0).toUpperCase()+sub.slice(1)+'</h2><ul>';
  (enfermedades[sub]||[]).forEach(e=>{
    html += `<li ondblclick="copiar('${e.titulo}: ${e.desc}')" id="enf_${e.id}">
      <strong>${e.titulo}</strong>: ${e.desc}
      <button class="fav-btn${isFav(e.id)?' faved':''}" title="Favorito" onclick="toggleFav('${e.id}')">${isFav(e.id)?'‚òÖ':'‚òÜ'}</button>
      <button class="copy-btn" title="Copiar" onclick="copiar('${e.titulo}: ${e.desc}')">üìã</button>
    </li>`;
  });
  html+='</ul>';
  document.getElementById('enfermedades-content').innerHTML = html;
}
// --- SUBNAV interacciones ---
document.querySelectorAll('#panel-interacciones .panel-nav button').forEach(btn=>{
  btn.onclick = function(){
    document.querySelectorAll('#panel-interacciones .panel-nav button').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    renderInteracciones(btn.dataset.sub);
  };
});
function renderInteracciones(sub){
  let html = '<h2>'+sub.charAt(0).toUpperCase()+sub.slice(1)+'</h2><ul>';
  (interacciones[sub]||[]).forEach(i=>{
    html += `<li ondblclick="copiar('${i.comb}: ${i.desc}')" id="int_${i.id}">
      <strong>${i.comb}</strong>: ${i.desc}
      <button class="fav-btn${isFav(i.id)?' faved':''}" title="Favorito" onclick="toggleFav('${i.id}')">${isFav(i.id)?'‚òÖ':'‚òÜ'}</button>
      <button class="copy-btn" title="Copiar" onclick="copiar('${i.comb}: ${i.desc}')">üìã</button>
    </li>`;
  });
  html+='</ul>';
  document.getElementById('interacciones-content').innerHTML = html;
}
// --- FAVORITOS PANEL ---
function renderFavoritos(){
  let favs = getFavs();
  let html = '';
  let found = false;
  Object.values(procedimientos).flat().forEach(p=>{
    if(favs.includes(p.id)){
      html += `<li ondblclick="copiar('${p.titulo}: ${p.desc}')"><strong>${p.titulo}</strong>: ${p.desc}
        <button class="fav-btn faved" title="Quitar de favoritos" onclick="toggleFav('${p.id}')">‚òÖ</button>
        <button class="copy-btn" title="Copiar" onclick="copiar('${p.titulo}: ${p.desc}')">üìã</button>
      </li>`;
      found = true;
    }
  });
  Object.values(enfermedades).flat().forEach(e=>{
    if(favs.includes(e.id)){
      html += `<li ondblclick="copiar('${e.titulo}: ${e.desc}')"><strong>${e.titulo}</strong>: ${e.desc}
        <button class="fav-btn faved" title="Quitar de favoritos" onclick="toggleFav('${e.id}')">‚òÖ</button>
        <button class="copy-btn" title="Copiar" onclick="copiar('${e.titulo}: ${e.desc}')">üìã</button>
      </li>`;
      found = true;
    }
  });
  Object.values(interacciones).flat().forEach(i=>{
    if(favs.includes(i.id)){
      html += `<li ondblclick="copiar('${i.comb}: ${i.desc}')"><strong>${i.comb}</strong>: ${i.desc}
        <button class="fav-btn faved" title="Quitar de favoritos" onclick="toggleFav('${i.id}')">‚òÖ</button>
        <button class="copy-btn" title="Copiar" onclick="copiar('${i.comb}: ${i.desc}')">üìã</button>
      </li>`;
      found = true;
    }
  });
  document.getElementById('favoritos-content').innerHTML = found ? '<ul>'+html+'</ul>' : '<div>No hay favoritos a√∫n.</div>';
}
// --- COMBINADOR ---
const allInteracciones = Object.values(interacciones).flat();
function buscarInteraccion(a,b){
  a=a.toLowerCase();b=b.toLowerCase();
  return allInteracciones.filter(i=>
    (a.includes(i.comb.split('+')[0].toLowerCase().trim()) && b.includes(i.comb.split('+')[1].toLowerCase().trim())) ||
    (b.includes(i.comb.split('+')[0].toLowerCase().trim()) && a.includes(i.comb.split('+')[1].toLowerCase().trim()))
  );
}
document.getElementById('checkComb').onclick = ()=>{
  const a = document.getElementById('medA').value.trim(), b = document.getElementById('medB').value.trim();
  if(!a || !b){document.getElementById('comb-result').textContent='Escriba dos medicamentos';return;}
  const res = buscarInteraccion(a,b);
  document.getElementById('comb-result').innerHTML = res.length
    ? res.map(r=>`<div style="color:#dc2626"><strong>Cr√≠tica:</strong> ${r.comb}: ${r.desc}</div>`).join('')
    : '<span style="color:#43e97b">No se detectaron interacciones cr√≠ticas en la base local.</span>';
};
// --- Lista completa de interacciones en Combinador ---
function renderAllInterList(){
  document.getElementById('all-inter-list').innerHTML =
    allInteracciones.map(i=>`<div><strong>${i.comb}</strong>: ${i.desc}</div>`).join('');
}
// --- Educaci√≥n panel y b√∫squeda ---
document.getElementById('eduSearchBox').oninput=function(e){
  const q = e.target.value.trim().toLowerCase();
  let html = "<ul>";
  educaci√≥n.forEach(ed=>{
    if(ed.titulo.toLowerCase().includes(q)||ed.desc.toLowerCase().includes(q)){
      html+=`<li><strong>${ed.titulo}</strong>: ${ed.desc}
        <button class="copy-btn" title="Copiar" onclick="copiar('${ed.titulo}: ${ed.desc}')">üìã</button>
      </li>`;
    }
  });
  html+="</ul>"; document.getElementById('educacion-content').innerHTML=html;
};
// --- Copiar al portapapeles (doble clic) ---
function copiar(txt){
  if(navigator.clipboard){navigator.clipboard.writeText(txt);}
  else{
    var temp = document.createElement('textarea');
    temp.value = txt;
    document.body.appendChild(temp);
    temp.select();
    document.execCommand('copy');
    document.body.removeChild(temp);
  }
}
// ---- Global Search ----
document.getElementById('globalSearchBox').oninput = function(e){
  const q = e.target.value.trim().toLowerCase();
  if(q.length<2){return;}
  let html = "<h3>Resultados globales:</h3><ul>";
  // Pacientes
  getPats().forEach(p=>{
    if(Object.values(p).join(' ').toLowerCase().includes(q)){
      html += `<li><strong>Paciente:</strong> ${p.name} (${p.diag})</li>`;
    }
  });
  // PAEs
  getPAE().forEach(pa=>{
    if(pa.diag.toLowerCase().includes(q)||pa.plan.toLowerCase().includes(q)){
      html += `<li><strong>PAE:</strong> ${pa.pat}: ${pa.diag} | ${pa.plan}</li>`;
    }
  });
  // Procedimientos
  Object.values(procedimientos).flat().forEach(pr=>{
    if(pr.titulo.toLowerCase().includes(q)||pr.desc.toLowerCase().includes(q)){
      html+=`<li><strong>Procedimiento:</strong> ${pr.titulo} - ${pr.desc}</li>`;
    }
  });
  // Enfermedades
  Object.values(enfermedades).flat().forEach(e=>{
    if(e.titulo.toLowerCase().includes(q)||e.desc.toLowerCase().includes(q)){
      html+=`<li><strong>Enfermedad:</strong> ${e.titulo} - ${e.desc}</li>`;
    }
  });
  // Interacciones
  Object.values(interacciones).flat().forEach(i=>{
    if(i.comb.toLowerCase().includes(q)||i.desc.toLowerCase().includes(q)){
      html+=`<li><strong>Interacci√≥n:</strong> ${i.comb} - ${i.desc}</li>`;
    }
  });
  // Educaci√≥n
  educaci√≥n.forEach(ed=>{
    if(ed.titulo.toLowerCase().includes(q)||ed.desc.toLowerCase().includes(q)){
      html+=`<li><strong>Educaci√≥n:</strong> ${ed.titulo} - ${ed.desc}</li>`;
    }
  });
  html+="</ul>";
  showPanel('educacion');
  document.getElementById('educacion-content').innerHTML = html;
};
// --- PACIENTES ---
const PAT_KEY='saludpro_pats';
function getPats(){return JSON.parse(localStorage.getItem(PAT_KEY)||'[]');}
function setPats(pats){localStorage.setItem(PAT_KEY,JSON.stringify(pats));}
function renderPatList(){
  let pats=getPats(), html='';
  if(!pats.length){document.getElementById('patList').innerHTML='<div>No hay pacientes registrados.</div>';return;}
  html='<ul>'+pats.map((p,i)=>`<li><strong>${p.name}</strong> (${p.edad} a√±os, ${p.gen}) - ${p.diag}
  <br><b>Alergias:</b> ${p.alergias||'-'} | <b>TA:</b> ${p.ta||'-'} | <b>FC:</b> ${p.fc||'-'} | <b>FR:</b> ${p.fr||'-'} | <b>Temp:</b> ${p.temp||'-'} | <b>SpO2:</b> ${p.spo2||'-'} | <b>Gluc:</b> ${p.gluc||'-'}
  </li>`).join('')+'</ul>';
  document.getElementById('patList').innerHTML=html;
}
document.getElementById('patSave').onclick=()=>{
  const name=$('patName').value.trim(), edad=$('patEdad').value.trim(), gen=$('patGen').value, diag=$('patDiag').value.trim(),
    alergias=$('patAlergias').value.trim(),
    ta=$('patTA').value.trim(), fc=$('patFC').value.trim(), fr=$('patFR').value.trim(), temp=$('patTemp').value.trim(), spo2=$('patSpO2').value.trim(), gluc=$('patGluc').value.trim();
  if(!name||!edad||!diag){$('patMsg').textContent='Complete todos los campos.';setTimeout(()=>{$('patMsg').textContent='';},1800);return;}
  let pats=getPats();pats.push({name,edad,gen,diag,alergias,ta,fc,fr,temp,spo2,gluc});setPats(pats);$('patMsg').textContent='Paciente guardado.';setTimeout(()=>{$('patMsg').textContent='';},1800);renderPatList();renderPatSelect();
};
// --- PERFIL ---
const PROF_KEY='saludpro_prof';
function getProf(){return JSON.parse(localStorage.getItem(PROF_KEY)||'{}');}
function setProf(prof){localStorage.setItem(PROF_KEY,JSON.stringify(prof));}
document.getElementById('profileSave').onclick=()=>{
  const name=$('userName').value.trim(), id=$('userId').value.trim(), rol=$('userRol').value;
  if(!name||!id){$('profileMsg').textContent='Complete nombre e ID.';setTimeout(()=>{$('profileMsg').textContent='';},1800);return;}
  setProf({name,id,rol});$('profileMsg').textContent='Perfil guardado.';setTimeout(()=>{$('profileMsg').textContent='';},1800);
};
// --- PAE ---
const PAE_KEY='saludpro_pae';
function getPAE(){return JSON.parse(localStorage.getItem(PAE_KEY)||'[]');}
function setPAE(pae){localStorage.setItem(PAE_KEY,JSON.stringify(pae));}
function renderPatSelect(){
  let pats=getPats(), sel=$('paePat');sel.innerHTML='';
  pats.forEach((p,i)=>{let opt=document.createElement('option');opt.value=p.name;opt.textContent=p.name;sel.appendChild(opt);});
}
document.getElementById('paeSave').onclick=()=>{
  const pat=$('paePat').value, diag=$('paeDiag').value.trim(), plan=$('paePlan').value.trim();
  if(!pat||!diag){$('paeMsg').textContent='Paciente y diagn√≥stico son requeridos.';setTimeout(()=>{$('paeMsg').textContent='';},1800);return;}
  let arr=getPAE();arr.push({pat,diag,plan,ts:Date.now()});setPAE(arr);$('paeMsg').textContent='PAE guardado.';setTimeout(()=>{$('paeMsg').textContent='';},1800);renderPAEList();
};
document.getElementById('paeExport').onclick=()=>{
  const data=localStorage.getItem(PAE_KEY)||'[]';
  const blob=new Blob([data],{type:'application/json'});
  const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='pae_export.json';a.click();a.remove();
};
function renderPAEList(){
  let arr=getPAE(), html='';
  if(!arr.length){$('paeList').innerHTML='<div>No hay PAEs guardados.</div>';return;}
  html='<ul>'+arr.map((p,i)=>`<li><strong>${p.pat}</strong>: <span>${p.diag}</span> <span>${p.plan}</span></li>`).join('')+'</ul>';
  $('paeList').innerHTML=html;
}
// --- Utilidad $
function $(id){return document.getElementById(id);}
window.onload=()=>{
  renderFavoritos();renderPatList();renderPatSelect();renderPAEList();
  // Recuperar perfil guardado
  let prof=getProf();
  if(prof.name){$('userName').value=prof.name;}
  if(prof.id){$('userId').value=prof.id;}
  if(prof.rol){$('userRol').value=prof.rol;}
};
</script>
</body>
</html>
